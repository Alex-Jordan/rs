{% extends "_base.html" %}
{% block title %}
My Course
{% endblock %}
{% block css %}

<link href="/staticAssets/index.css" rel="stylesheet" media="screen" />
<link href="/staticAssets/course.css" rel="stylesheet" media="screen" />
{% endblock %}

{% block backTo %}
textbook
{% endblock %}

{% block navitems %}
{% if course_list|length > 1 %}
<li class="nav-item">
  <span class="nav-link">
    Change course:
    <select id="course_chooser" onchange="change_course()">
      {% for course in course_list: %}
      <option {% if course.course_name == course_name %}selected{% endif %} value="{{course.course_name}}">
        {{course.course_name}}
      </option>
      {% endfor %}
    </select>
  </span>
</li>
{% endif %}
{% endblock %}

{% block content %}
<div class="course_page">
<div>
    <h2>{{course.course_name}}</h2>
    <p>{{course_description}}</p>
    <p><b>School:</b>{{institution}}</p>
    <p><b>Student:</b> {{user.first_name}} {{user.last_name}} (<a href="/runestone/default/user/logout">Not you?</a>)</p>
    <h2>Instructors</h2>
    <ul>
      {% for instructor in instructor_list: %}
      <li>
        {{instructor.first_name}} {{instructor.last_name}} (<a href="mailto:{{instructor.email}}">{{instructor.email}}</a>)
      </li>
      {% endfor %}
    </ul>
</div>
<div>
<h2>Textbooks</h2>
<ul>
    {% for book in book_list: %}
    <li><a href="/ns/books/published/{{course.course_name}}/{{book.main_page}}">{{book.title}}</a>
    {% if lastPageUrl %}
     (<a href="{{lastPageUrl}}">Last Page</a>)
    {% endif %}
    </li>
    {% endfor %}
</ul>

</div>
<div class="assignment_chooser">
  {% include 'assignment/student/assignment_block.html'%}
</div>
<script>
async function change_course(course_name) {
    let new_course = document.getElementById("course_chooser").value
    let request = new Request(`/ns/course/changeCourse/${new_course}`, {
        method: "GET",
    });
    await fetch(request);
    window.location.href = "/ns/course/index"
}
</script>
</div>
{% endblock %}

{% block js %}
<script src="/staticAssets/assignment/student.js"></script>
{% endblock %}
